(this["webpackJsonpredux-jest-exercise"]=this["webpackJsonpredux-jest-exercise"]||[]).push([[0],{37:function(e,t,r){},38:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r(14),a=r.n(c),s=r(10),i=r(3),o=r(4),u=r.n(o),d=r(9),j=r(5),l=r(15),b=Object(j.b)("users/auth/changePassword",function(){var e=Object(d.a)(u.a.mark((function e(t,r){var n,c,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.getState().auth,e.next=3,fetch("https://identitytoolkit.googleapis.com/v1/accounts:update?key=".concat("AIzaSyBhYMnYXVVqqfk_BB3TaRywhdEp0WssYbA"),{method:"POST",body:JSON.stringify({idToken:n.idToken,password:t,returnSecureToken:!0}),header:{"Content-Type":"application/json"}});case 3:return c=e.sent,e.next=6,c.json();case 6:if(a=e.sent,c.ok){e.next=11;break}return e.abrupt("return",r.rejectWithValue(a.error.message));case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),p=Object(j.b)("users/auth/signUp",function(){var e=Object(d.a)(u.a.mark((function e(t,r){var n,c,a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,c=t.password,e.next=3,fetch("https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=".concat("AIzaSyBhYMnYXVVqqfk_BB3TaRywhdEp0WssYbA"),{method:"POST",body:JSON.stringify({email:n,password:c,returnSecureToken:!0}),header:{"Content-Type":"application/json"}});case 3:return a=e.sent,e.next=6,a.json();case 6:if(s=e.sent,a.ok){e.next=11;break}return e.abrupt("return",r.rejectWithValue(s.error.message));case 11:return e.abrupt("return",s);case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),h=Object(j.b)("users/auth/signIn",function(){var e=Object(d.a)(u.a.mark((function e(t,r){var n,c,a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,c=t.password,e.prev=1,e.next=4,fetch("https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=".concat("AIzaSyBhYMnYXVVqqfk_BB3TaRywhdEp0WssYbA"),{method:"POST",body:JSON.stringify({email:n,password:c,returnSecureToken:!0}),header:{"Content-Type":"application/json"}});case 4:return a=e.sent,e.next=7,a.json();case 7:if(s=e.sent,a.ok){e.next=11;break}return console.log(s),e.abrupt("return",r.rejectWithValue(s.error.message));case 11:return e.abrupt("return",s);case 14:return e.prev=14,e.t0=e.catch(1),e.abrupt("return",r.rejectWithValue(e.t0));case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t,r){return e.apply(this,arguments)}}()),f=Object(j.c)({name:"auth",initialState:{idToken:"",isLoggedIn:!1,errorMessage:""},reducers:{signOutUser:function(e,t){e.isLoggedIn=!1,localStorage.removeItem("idToken"),e.idToken=null},logInUser:function(e,t){e.isLoggedIn=!0,e.idToken=t.payload},resetError:function(e,t){e.errorMessage=""}},extraReducers:function(e){e.addCase(b.rejected,(function(e,t){e.errorMessage=t.payload})).addCase(b.pending,(function(e,t){})).addCase(b.fulfilled,(function(e,t){localStorage.setItem("idToken",t.payload.idToken)})).addCase(p.rejected,(function(e,t){e.errorMessage=t.payload})).addCase(p.pending,(function(e,t){})).addCase(p.fulfilled,(function(e,t){e.isLoggedIn=!0,e.idToken=t.payload.idToken,localStorage.setItem("idToken",t.payload.idToken)})).addCase(h.rejected,(function(e,t){e.errorMessage=t.payload})).addCase(h.pending,(function(e,t){})).addCase(h.fulfilled,(function(e,t){e.isLoggedIn=!0,e.idToken=t.payload.idToken,localStorage.setItem("idToken",t.payload.idToken)}))}}),O=f.actions,x=(Object(l.a)([function(e){return e.auth.idToken}],(function(e){return""!==e})),f),m=r(1),g=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.auth.isLoggedIn}));return Object(m.jsxs)("header",{className:"header",children:[Object(m.jsx)("h1",{children:"Redux Exercise"}),Object(m.jsx)("ul",{className:"navbar",children:t?Object(m.jsxs)(n.Fragment,{children:[Object(m.jsx)("li",{children:Object(m.jsx)(s.b,{to:"/shop",children:"Shop"})}),Object(m.jsx)("li",{children:Object(m.jsx)(s.b,{to:"/cart",children:"Cart"})}),Object(m.jsx)("li",{children:Object(m.jsx)(s.b,{to:"/profile",children:"Profile"})}),Object(m.jsx)("li",{children:Object(m.jsx)(s.b,{to:"/",onClick:function(){e(O.signOutUser())},children:"Logout"})})]}):Object(m.jsx)("li",{children:Object(m.jsx)(s.b,{to:"/login",children:"Login"})})})]})},v=r(11),y=Object(j.b)("cart/sendCart",function(){var e=Object(d.a)(u.a.mark((function e(t,r){var n,c,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.getState().cart,e.prev=1,e.next=4,fetch("https://react-auth-practice-b646a-default-rtdb.europe-west1.firebasedatabase.app/cart.json",{method:"PUT",body:JSON.stringify(n.items)});case 4:return c=e.sent,e.next=7,c.json();case 7:if(a=e.sent,c.ok){e.next=10;break}return e.abrupt("return",r.rejectWithValue(a.err.message));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,r){return e.apply(this,arguments)}}()),k=Object(j.c)({name:"cart",initialState:{items:[],changed:!1},reducers:{replaceCart:function(e,t){e.items=t.payload},addItemToCart:function(e,t){var r=t.payload,n=e.items.find((function(e){return r.id===e.id}));n?(n.quantity++,n.totalPrice+=n.price):e.items.push(r)},removeItemFromCart:function(e,t){var r=t.payload,n=e.items.find((function(e){return e.id===r}));1===n.quantity?e.items=e.items.filter((function(e){return e.id!==r})):(n.quantity--,n.totalPrice=n.totalPrice-n.price)}},extraReducers:function(e){e.addCase(y.rejected=function(e,t){})}}),w=k.actions,T=k,C=function(e){var t=Object(i.b)();return Object(m.jsxs)("div",{className:"cart-item",children:[Object(m.jsx)("p",{children:e.name}),Object(m.jsxs)("p",{children:[e.price,"$"]}),Object(m.jsxs)("p",{children:["Quantity:",e.quantity]}),Object(m.jsx)("button",{onClick:function(){t(w.removeItemFromCart(e.id))},children:"Remove"})]})},S=function(){var e=Object(n.useState)(0),t=Object(v.a)(e,2),r=t[0],c=t[1],a=Object(i.b)(),s=Object(i.c)((function(e){return e.cart.items})),o=0;s.forEach((function(e){o+=e.totalPrice}));return Object(n.useEffect)((function(){c(o),a(y())}),[s,a,o]),Object(m.jsxs)("div",{className:"cart",children:[!s&&s.map((function(e){return Object(m.jsx)(C,{id:e.id,name:e.name,price:e.price,quantity:e.quantity},e.id)})),Object(m.jsxs)("p",{children:["Total Amount:",r,"$"]}),Object(m.jsx)("button",{onClick:function(){a(w.replaceCart([])),a(y())},children:"Checkout"})]})},I=r(2),N=function(){var e=Object(n.useState)(""),t=Object(v.a)(e,2),r=t[0],c=t[1],a=Object(i.b)(),s=Object(i.c)((function(e){return e.auth})),o=Object(I.g)();Object(n.useEffect)((function(){a(O.resetError())}),[a]);var l=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,a(b(r));case 4:n=e.sent,c=Object(j.d)(n),a(O.logInUser(c.idToken)),n.error||o.push("/shop"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)("div",{children:Object(m.jsxs)("form",{onSubmit:l,children:[Object(m.jsx)("p",{className:"error",children:s.errorMessage}),Object(m.jsx)("label",{htmlFor:"password",children:"New Password"}),Object(m.jsx)("input",{type:"text",onChange:function(e){c(e.target.value)}}),Object(m.jsx)("button",{type:"submit",children:"Change Password"})]})})},E=[{id:1,name:"Jean",price:8},{id:2,name:"T-shirt",price:6},{id:3,name:"Hoodie",price:14}],P=function(){var e=Object(i.b)();return Object(m.jsx)("div",{children:Object(m.jsx)("ul",{className:"shop-list",children:E.map((function(t){return Object(m.jsxs)("li",{className:"shop-item",children:[Object(m.jsx)("p",{children:t.name}),Object(m.jsxs)("p",{children:[t.price,"$"]}),Object(m.jsx)("button",{onClick:function(){return function(t){var r={id:t.id,name:t.name,price:Number(t.price),quantity:1,totalPrice:Number(t.price)};e(w.addItemToCart(r))}(t)},children:"Add to Cart"})]},t.id)}))})})},q=function(){return Object(m.jsx)("div",{children:Object(m.jsx)("p",{children:"Please login to continue"})})},L=function(){var e=Object(i.c)((function(e){return e.auth.errorMessage})),t=Object(n.useState)(""),r=Object(v.a)(t,2),c=r[0],a=r[1],o=Object(n.useState)(""),l=Object(v.a)(o,2),b=l[0],p=l[1],f=Object(i.b)(),x=Object(I.g)();Object(n.useEffect)((function(){f(O.resetError())}),[f]);var g=function(){var e=Object(d.a)(u.a.mark((function e(t){var r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,f(h({email:c,password:b}));case 4:r=e.sent,n=Object(j.d)(r),f(O.logInUser(n.idToken)),r.error||x.push("/shop"),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(1);case 12:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)("div",{children:Object(m.jsxs)("form",{className:"login-form",onSubmit:g,children:[Object(m.jsx)("h2",{children:"Login"}),Object(m.jsx)("p",{className:"error",children:e}),Object(m.jsx)("label",{htmlFor:"email",children:"Enter your e-mail"}),Object(m.jsx)("input",{"aria-label":"email",type:"email",onChange:function(e){a(e.target.value)}}),Object(m.jsx)("label",{htmlFor:"password",children:"Enter your password"}),Object(m.jsx)("input",{"aria-label":"password",type:"password",onChange:function(e){p(e.target.value)}}),Object(m.jsx)("button",{children:"Login"}),Object(m.jsx)(s.b,{to:"/signup",className:"signup-button",children:"Create new account"})]})})},M=function(){var e=Object(n.useState)(""),t=Object(v.a)(e,2),r=t[0],c=t[1],a=Object(n.useState)(""),s=Object(v.a)(a,2),o=s[0],l=s[1],b=Object(i.c)((function(e){return e.auth.errorMessage})),h=Object(i.b)(),f=Object(I.g)();Object(n.useEffect)((function(){h(O.resetError())}),[h]);var x=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,h(p({email:r,password:o}));case 4:n=e.sent,c=Object(j.d)(n),h(O.logInUser(c.idToken)),n.error||f.push("/shop"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)("div",{children:Object(m.jsxs)("form",{onSubmit:x,children:[Object(m.jsx)("h2",{children:"Signup"}),Object(m.jsx)("p",{className:"error",children:b}),Object(m.jsx)("label",{htmlFor:"email",children:"Create your e-mail"}),Object(m.jsx)("input",{type:"email",onChange:function(e){c(e.target.value)}}),Object(m.jsx)("label",{htmlFor:"password",children:"Create your password"}),Object(m.jsx)("input",{type:"password",onChange:function(e){l(e.target.value)}}),Object(m.jsx)("button",{children:"Signup"})]})})};var V=function(){var e=Object(i.c)((function(e){return e.auth.isLoggedIn})),t=Object(i.b)();return Object(n.useEffect)((function(){var e=localStorage.getItem("idToken");e&&t(O.logInUser(e))}),[t]),Object(m.jsxs)("div",{className:"app",children:[Object(m.jsx)(g,{}),Object(m.jsx)("main",{children:Object(m.jsxs)(I.d,{children:[Object(m.jsx)(I.b,{path:"/",exact:!0,children:e?Object(m.jsx)(I.a,{to:"/shop"}):Object(m.jsx)(q,{})}),e&&Object(m.jsxs)(n.Fragment,{children:[Object(m.jsx)(I.b,{path:"/cart",children:Object(m.jsx)(S,{})}),Object(m.jsx)(I.b,{path:"/profile",children:Object(m.jsx)(N,{})}),Object(m.jsx)(I.b,{path:"/shop",children:Object(m.jsx)(P,{})})]}),Object(m.jsx)(I.b,{path:"/login",children:Object(m.jsx)(L,{})}),Object(m.jsx)(I.b,{path:"/signup",children:Object(m.jsx)(M,{})}),Object(m.jsx)(I.b,{path:"*",children:Object(m.jsx)(I.a,{to:"/"})})]})})]})},B=(r(37),Object(j.a)({reducer:{auth:x.reducer,cart:T.reducer}}));a.a.render(Object(m.jsx)(i.a,{store:B,children:Object(m.jsx)(s.a,{children:Object(m.jsx)(V,{})})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.27e3f478.chunk.js.map